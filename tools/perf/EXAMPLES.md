# Performance Tracking Example

This document provides examples of how the performance tracking system works.

## Example PR Comment

When a pull request is created, the performance tracking workflow will post a comment like this:

```markdown
## üìä Performance Benchmark Results

# Performance Comparison Report

## AOT Native Console File Size
- **Current Size:** 12.34 MB
- **Regression Detected:** NO ‚úÖ

## Benchmark Performance

### SimplePoco.DeserializeMapInit
- **Regression Detected:** NO ‚úÖ

### SimplePoco.DeserializeMap
- **Regression Detected:** NO ‚úÖ

### SimplePoco.SerializeMap
- **Regression Detected:** NO ‚úÖ

### SimplePoco.SerializeAsArray
- **Regression Detected:** NO ‚úÖ

### SimplePoco.DeserializeAsArray
- **Regression Detected:** NO ‚úÖ

## Overall Result
- **Total Regressions:** 0
- **Build Status:** PASS ‚úÖ

---
*Generated on 2024-01-15 10:30:45 UTC*

### Details
This comment was automatically generated by the performance benchmarking workflow. The analysis compares this PR's performance against the last 10 CI builds on the main branch.

**Regression Detection:**
- Performance regressions are detected when results exceed 2 standard deviations from the historical mean
- Both benchmark execution time and AOT native file size are monitored
- Any detected regression will cause the build to fail

**Tracked Benchmarks:**
- `SimplePoco.DeserializeMapInit`
- `SimplePoco.DeserializeMap`
- `SimplePoco.SerializeMap`
- `SimplePoco.SerializeAsArray`
- `SimplePoco.DeserializeAsArray`
```

## Example Regression Detection

If a performance regression is detected, the comment would look like this:

```markdown
## üìä Performance Benchmark Results

# Performance Comparison Report

## AOT Native Console File Size
- **Current Size:** 15.67 MB  
- **Regression Detected:** YES ‚ùå

## Benchmark Performance

### SimplePoco.DeserializeMapInit
- **Regression Detected:** NO ‚úÖ

### SimplePoco.SerializeMap
- **Regression Detected:** YES ‚ùå

## Overall Result
- **Total Regressions:** 2
- **Build Status:** FAIL ‚ùå

---
*Generated on 2024-01-15 10:30:45 UTC*
```

In this case, the build would fail, and the PR would need to be updated to address the performance regressions before it can be merged.

## Azure Table Storage Schema

The system stores data in Azure Table Storage with the following structure:

### AOT File Size Data
```
PartitionKey: "AotFileSize"
RowKey: "{CloudBuildNumber}"
Fields:
- CommitId
- CloudBuildNumber  
- Version
- VersionMajor
- VersionMinor
- BuildNumber
- FileSizeMB
```

### Benchmark Data
```
PartitionKey: "Benchmark"
RowKey: "{CloudBuildNumber}-{MethodName}"
Fields:
- CommitId
- CloudBuildNumber
- Version
- VersionMajor
- VersionMinor
- BuildNumber
- MethodName
- Mean
- StdDev
- Min
- Max
- Allocated
```

This structure allows for efficient querying of historical data for trend analysis.